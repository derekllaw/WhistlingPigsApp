<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Whistling Pigs Algorithm</title>
    <link rel="stylesheet" href="style.css">
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
    <meta name = "viewport" content = "width = device-width">
    <meta name = "viewport" content = "initial-scale = 1.0, user-scalable = no">
    <script>
    $(document).ready(function() {

      $('#answer').hide();
      $('#tip').hide();

      $('input[name=inctip]').change(function() {
        if ($('input[name=inctip]').is(':checked'))
        {
          $('#tip').hide('slow', function()
          {
            $("input[name=tip]").val(0);
          });
        }
        else
        {
          var bill = parseFloat($("input[name=bill]").val());
          var tip  = (bill*0.1);
          $("input[name=tip]").val(tip.toFixed(2));
          $('#tip').show('slow');
        }
      });

    	$("form").submit(function() {
          var kitty = parseFloat($("input[name=kitty]").val());
    	  var bill  = parseFloat($("input[name=bill]").val());
    	  var tip   = parseFloat($("input[name=tip]").val());
    	  var pigs  = parseInt($("select[name=pigs]").val());

    	  if (isNaN(bill))
    	  {
            alert("That was a cheap meal, eh Angus?");
    	  }
    	  else
    	  {
            if (isNaN(kitty)) { kitty = 0.0; }
            if (isNaN(tip)) { tip = 0.0; }

            var perpig = ((bill + tip) - kitty)/pigs;
            perpig = (Math.ceil(perpig*2)/2).toFixed(2);    // round up to 50p
            var total = ((perpig*pigs) + kitty).toFixed(2);
            var min = (bill + tip).toFixed(2);

            $('#answer').slideUp('slow', function()
            {
              $("span[name=perpig]").text('\u00A3' + perpig).show();
              $("span[name=per2pig]").text('\u00A3' + (perpig*2).toFixed(2)).show();
              $("span[name=total]").text("\u00A3" + total).show();
              if (tip>0)
              {
                $("span[name=min]").text("(\u00A3" + min + ")").show();
              }
              else
              {
                $("span[name=min]").text(" ").show();
              }
            });
            $('#answer').slideDown('slow');
          }
    	  return false;
    	});

  	});
    </script>
    <style>
    #answer
    {
      background: #FFF;
      border: 1px solid;
      width: 230px;
    }
    .cash
    {
      width: 5em;
    }
    </style>
  </head>
  <body>
    <form type="submit" name="submit">
      <h3><a href="index.htm">Whistling Pigs</a> <a href="index.htm#paybill">Algorithm</a></h3>
      <table>
      <tr><td align="right">Kitty</td><td>&pound;</td><td><input class="cash" type="number" step="0.01" value="20" name="kitty"></td></tr>
      <tr><td align="right">Bill</td><td>&pound;</td><td><input class="cash" type="number" step="0.01" value="100" name="bill" width="6em"></td><td><input type="checkbox" checked name="inctip">includes tip</td></tr>
      </table>
      <table id="tip">
      <tr><td align="right">Tip</td><td>&pound;</td><td><input class="cash" type="number" step="0.01" value="0" name="tip"></td></tr>
      </table>
      <table>
      <tr><td align="right">Pigs</td><td>&nbsp;</td><td><select name="pigs">
                             <option value="2">2</option>
                             <option value="3">3</option>
                             <option value="4">4</option>
                             <option value="5">5</option>
                             <option value="6">6</option>
                             <option value="7">7</option>
                             <option value="8">8</option>
                             <option value="9">9</option>
                             <option value="10">10</option>
                             <option value="11">11</option>
                             <option value="12">12</option>
                             <option value="13">13</option>
                             <option value="14">14</option>
                             <option value="15">15</option>
                             <option value="16">16</option>
                             <option value="17">17</option>
                             <option value="18">18</option>
                             <option value="19">19</option>
                             <option value="20">20</option>
                             <option value="21">21</option>
                             <option value="22">22</option>
                             <option value="23">23</option>
                             <option value="24">24</option>
                             <option value="25">25</option>
                             <option value="26">26</option>
                             <option value="27">27</option>
                             <option value="28">28</option>
                             <option value="29">29</option>
                             <option value="30">30</option>
                             <option value="31">31</option>
                             <option value="32">32</option>
                             <option value="33">33</option>
                             <option value="34">34</option>
                             <option value="35">35</option>
                             <option value="36">36</option>
                             <option value="37">37</option>
                             <option value="38">38</option>
                             <option value="39">39</option>
                             <option value="40">40</option>
                             <option value="41">41</option>
                             <option value="42">42</option>
                             <option value="43">43</option>
                             <option value="44">44</option>
                             <option value="45">45</option>
                             <option value="46">46</option>
                             <option value="47">47</option>
                             <option value="48">48</option>
                             <option value="49">49</option>
                             <option value="50">50</option>
                           </select></td><td><button type="submit">Calculate</button></td></tr>
      </table>
    </form>
    <hr>
    <div id="answer">
    Per Pig <b><span name="perpig"></span></b>, Per 2 Pigs <b><span name="per2pig"></span></b><br>
    Total <b><span name="total"></span></b> <span name="min"></span>
    </div>
  </body>
</html>
